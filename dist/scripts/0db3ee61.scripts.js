(function(){"use strict";angular.module("koboApp",["ngResource","ngAnimate","pascalprecht.translate"]).config(["$translateProvider","langJa","langEn",function(a,b,c){return a.translations("en",c),a.translations("ja",b),a.preferredLanguage("ja")}]).config(["$locationProvider",function(a){return a.html5Mode(!0)}]).run(["$rootScope",function(a){return a.langs=["ja","en"],a.lang={},a.lang.selected="ja",a.rootUrl=location.origin}])}).call(this),function(){"use strict";angular.module("koboApp").controller("MainCtrl",["$scope","$anchorScroll","$location","kobo","$translate","minUrl",function(a,b,c,d,e,f){var g,h;return a.result={},a.genres=[],a.searchConds={},a.searchConds.page=1,a.searchConds.sort="standard",a.loaded=!1,a.searching=!1,a.minUrl="",h=function(){var b,e;return e=c.absUrl(),b=e.match(/[¥/][¥?]([0-9]+)_/),b&&b.length>1?(a.result.Items=1,a.searchConds.koboId=b[1],d.getBookById(a.searchConds.koboId,function(b){return a.loaded=!0,a.result=b}),f.insert(e,function(b){return a.minUrl=b,a.$apply()})):a.loaded=!0},h(),a.$watch("lang.selected",function(b){return e.uses(b),a.sorts=d.getSortNames()}),a.sorts=d.getSortNames(),g=function(){return b(),d.getBooks(a.search,a.searchConds.page,a.searchConds.genreId,a.searchConds.sort,function(b){var c;return a.result=b,c=d.filterGenre(b),a.genres=[],angular.forEach(c,function(b){return d.getGenres(b,function(b){return a.genres.push(b)})}),a.searching=!1})},a.onSearchClicked=function(){return a.searchConds.koboId=void 0,a.searchConds.page=1,a.searching=!0,g()},a.hasNext=function(){return a.result.count&&a.result.count>a.result.last},a.onNextClicked=function(){return a.searchConds.page+=1,a.searching=!0,g()},a.onPrevClicked=function(){return a.searchConds.page-=1,a.searching=!0,g()},a.onGenreSearchClicked=function(b){return a.searchConds.page=1,a.searchConds.genreId=b,a.searching=!0,g()},a.genreClearSearchClicked=function(){return a.searchConds.page=1,a.searchConds.genreId=void 0,a.searching=!0,g()},a.sortSelected=function(){return a.searching=!0,g()}}])}.call(this),function(){"use strict";angular.module("koboApp").constant("langJa",{EN:"英語",JA:"日本語",main:{title:"Kobo 書籍検索",subTitle:"すぐに、そのまま。",btnValue:"検索"},contents:{genre:"ジャンル",pager:"{{count}}件中 {{first}}〜{{last}}件までの表示",yen:"{{price}}円",prev:"前へ",next:"次へ",none:"検索しましたが、見つかりませんでした。",reader:"Kobo 端末",coupon:"クーポンコード",close:"閉じる"},sort:{relate:"関連度の高い順",releaseNew:"発売日の新しい順",reviewCount:"レビューの件数が多い順",reviewHigh:"レビューの評価が高い順",itemPriceRow:"価格が安い順",itemPriceHigh:"価格が高い順"},detail:{author:"{{author}} (著)",price:"価格: ",buy:"Kobo ストアで購入",coupon:"クーポンコードをチェック",compare:"Amazon レビューをチェック",twitter:"クリックしてTwitterでシェアしよう"}})}.call(this),function(){"use strict";angular.module("koboApp").constant("langEn",{EN:"English",JA:"Japanese",main:{title:"Kobo Search",subTitle:"Search it, Read it.",btnValue:"Search"},contents:{genre:"Genre",pager:"Showing {{first}}-{{last}} of {{count}} Results",yen:"{{price}} Yen",prev:"Prev",next:"Next",none:"Oops, your search did not match any producs.",reader:"Kobo E-Reader",coupon:"Coupon Code",couponSuccess:"Success Rate"},sort:{relate:"Relevance",releaseNew:"New",reviewCount:"Most Reviews",reviewHigh:"Avg. Custromer Review",itemPriceRow:"Price: Low to High",itemPriceHigh:"Price: High to Low"},detail:{author:"by {{author}}",price:"Price: ",buy:"Buy this at Kobo Store",coupon:"Check coupon code",compare:"Check Amazon Review",twitter:"Click and Share on Twitter"}})}.call(this),function(){"use strict";angular.module("koboApp").constant("rwsConf",{baseurl:"https://app.rakuten.co.jp/services/api/Kobo/EbookSearch/20131010",genreurl:"https://app.rakuten.co.jp/services/api/Kobo/GenreSearch/20131010",appid:"295e52495b7dee04d9c1d6ea07dfbb9e",affid:"0fec64cf.502ad1e1.0fec64d0.1823de0d",apiKey:"AIzaSyDwfRpITS2_7PDAKE5rEvDm6B4wV_1yfSg",kimonoKey:"0b98d198323093974b7e3b14d41f54a5",format:"json",defaultSort:"standard",defaultGenre:101,sort:[{name:"sort.relate",value:"standard"},{name:"sort.releaseNew",value:"-releaseDate"},{name:"sort.reviewCount",value:"reviewCount"},{name:"sort.reviewHigh",value:"reviewAverage"},{name:"sort.itemPriceRow",value:"+itemPrice"},{name:"sort.itemPriceHigh",value:"-itemPrice"}]})}.call(this),function(){"use strict";angular.module("koboApp").factory("kobo",["$http","$translate","rwsConf",function(a,b,c){var d,e;return d=function(){return"?applicationId="+c.appid+"&affiliateId="+c.affid+"&format="+c.format+"&hits=24&field=0&orFlag=1&callback=JSON_CALLBACK"},e=function(){return c.sort},{getBooks:function(b,e,f,g,h){var i;return null==f&&(f=c.defaultGenre),null==g&&(g=c.defaultSort),i=d()+"&keyword="+b+"&koboGenreId="+f+"&page="+e+"&sort="+g,a.jsonp(c.baseurl+i).success(function(a){return h(a)})},getBookById:function(b,e){var f;return f=d()+"&itemNumber="+b,a.jsonp(c.baseurl+f).success(function(a){return e(a)})},getGenres:function(b,e){var f;return f=d()+"&koboGenreId="+b,a.jsonp(c.genreurl+f).success(function(a){return e(a)})},filterGenre:function(a){var b;return b=[],angular.forEach(a.Items,function(a){var c,d;return c=a.Item.koboGenreId,d=c.split("/"),angular.forEach(d,function(a){return b.indexOf(a)<0?b.push(a):void 0})}),b},getSortNames:function(){var a,c;return c=e(),a=[],angular.forEach(c,function(c){var d;return d={name:b(c.name),value:encodeURIComponent(c.value)},a.push(d)}),a}}}])}.call(this),function(){"use strict";angular.module("koboApp").controller("RateCtrl",["$scope",function(a){var b;return a.number=5,a.getNumber=function(a){var b;return b=new Array(a)},b=function(a){return Math.round(parseFloat(a))},a.shouldStared=function(a,c){return a<b(c)}}])}.call(this),function(){"use strict";angular.module("koboApp").filter("encode",function(){return function(a){return encodeURIComponent(a.replace(/[ ]/g,"_")).replace(/[!'()]/g,escape).replace(/\*/g,"%2A")}})}.call(this),function(){"use strict";angular.module("koboApp").factory("minUrl",["rwsConf",function(a){return{insert:function(b,c){return gapi.client.setApiKey(a.apiKey),gapi.client.load("urlshortener","v1",function(){return gapi.client.urlshortener.url.insert({resource:{longUrl:b}}).execute(function(a){return c(a.id)})})}}}])}.call(this),function(){"use strict";angular.module("koboApp").factory("coupon",["$http","rwsConf",function(a,b){var c,d,e,f,g;return f="http://www.kimonolabs.com/api/",d="cczppw9u",e="794yy2be",c="?apikey="+b.kimonoKey,g="&callback=JSON_CALLBACK",{fetch:function(b){return a.jsonp(f+d+c+g,{cache:!0}).success(function(a){return b(a)})},fetchJp:function(b){var d;return d={},a.jsonp(f+e+c+g,{cache:!0}).success(function(a){var c,e,f,g,h,i,j,k;try{for(f=a.results.collection1[0].coupon,g=f.split(/\r\n|\r|\n/),c="",k=[],i=0,j=g.length;j>i;i++)h=g[i],h.match(/[0-9]+%/)&&(c=h.match(/[0-9]+%/)[0]),h.match(/[［](.*)[］]/)?(d[c]||(d[c]=[]),k.push(d[c].push(h.match(/[［](.*)[］]/)[1]))):k.push(void 0);return k}catch(l){return e=l,d={"failed.. contact to admin.":""}}finally{b(d)}})}}}])}.call(this),function(){"use strict";angular.module("koboApp").controller("CouponCtrl",["$scope","coupon",function(a,b){return a.coupon={},a.coupons=null,a.hasCoupon=function(){return a.coupon.lastrunstatus&&"success"===a.coupon.lastrunstatus&&a.coupon.results.collection1[0].off&&!!a.coupon.results.collection1[0].off.match(/([0-9]+)%/)},a.onCouponShowClick=function(){return b.fetchJp(function(b){return a.coupons=b})},a.onCouponCloseClick=function(){return a.coupons=null}}])}.call(this);